<script>
  // Get container div to hold property cards
  let container = document.querySelector('.container');

  // Pull data from back-end, getProperties() returns the array of data
  google.script.run.withSuccessHandler(showData).getProperties();

  // Display data on front-end by creating cards
  function showData(dataArray) {
    for(var i=0; i<dataArray.length; i++) {
      let card = document.createElement('div');
      card.classList.add('card');

      let name = document.createElement('div');
      name.textContent = dataArray[i][1];
      card.appendChild(name);

      let city = document.createElement('div');
      city.textContent = dataArray[i][2];
      card.appendChild(city);

      let state = document.createElement('div');
      state.textContent = dataArray[i][3];
      card.appendChild(state);

      let type = document.createElement('div');
      type.textContent = dataArray[i][4];
      card.appendChild(type);

      let guests = document.createElement('div');
      guests.textContent = dataArray[i][5];
      card.appendChild(guests);

      let beds = document.createElement('div');
      beds.textContent = dataArray[i][6];
      card.appendChild(beds);

      let baths = document.createElement('div');
      baths.textContent = dataArray[i][7];
      card.appendChild(baths);

      let price = document.createElement('div');
      price.textContent = dataArray[i][8];
      card.appendChild(price);

      let img = document.createElement('img');
      img.src = `${dataArray[i][9]}`;
      img.style = 'height: 250px; width: 400px;';
      card.appendChild(img);

      let link = document.createElement('div');
      link.innerHTML = `<a href="https://script.google.com/macros/s/AKfycbwxYsTpb3W3QObNYOfYuBVjq8O6FOSQ4rAS9_yUBqY/dev/book?propertyId=${dataArray[i][0]}">Book a stay`;
      card.appendChild(link);

      container.appendChild(card);
    }
  }
</script>