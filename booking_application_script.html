<script>
  // Prevent forms from submitting prematurely
  function preventFormSubmit() {
    let forms = document.querySelectorAll('form');
    forms.forEach(form => form.addEventListener('submit', function(event) {
      event.preventDefault();
    }));
  }
  
  // Prevent page from redirecting to an inaccurate URL in the event of an exception
  window.addEventListener('load', preventFormSubmit);

  // Handle form submit, run displayConfirmation after processBookingForm(formObject) is successful
  function handleBookingFormSubmit(formObject) {
    google.script.run.withSuccessHandler(displayConfirmation).processBookingForm(formObject);
  }

  // Show confirmation of booking after submission on page
  function displayConfirmation() {
    let confirmation = document.getElementById('confirmation');
    confirmation.innerHTML = 'Your booking application has been received!<br>Application details have been emailed to you, but please wait until you receive official confirmation of your stay.<br><br>';
  }
</script>